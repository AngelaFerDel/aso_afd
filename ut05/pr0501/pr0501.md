#### [Volver a Unidad 5](../index.md)

------------

# Unidad 5 - Pr치ctica 1: Implantaci칩n del dominio.

Para la ejecuci칩n de esta pr치ctica ser치 necesaria una m치quina virtual de Windows Server. 
Deber치 tener 2 adaptadores:
- Uno en solo-anfitri칩n.
- Uno en NAT.
Lo primero que deberemos de hacer es configurarle una IP est치tica en el adaptador solo-anfitri칩n, siendo esta la que nos da VirtualBox, de esta manera estamos protegidos de que nos pueda cambiar la IP el DHCP de Virtualbox.
Adem치s. tambien pondremos que el DNS es nuestro propia m치quina (172.0.0.1)

## Ejercicio 1 - Promoci칩n del controlaor de dominio.

Una vez tenemos la m치quina lista, desde Administrador del Servidor (se abre autom치ticamente al iniciar Windows Server). Deberemos ir a men칰 superior a la derecha donde pone **Herramientas > Agregar roles** y caracter칤sticas.

Dejaremos los valores por defecto a excepci칩n del apartado de **Roles del servidor**. Donde debemos marcar la casilla de: **Servicios de dominio de Active Directory**.

![Captura apartado 1](pr0501_Capturas/pr0501_1.png)

Despu칠s de que le demos al bot칩n de instalar, esperaremos hasta que se instale.

Cuando haya terminado, si nos fijamos, en el icono de la bandera tenemos un s칤mbolo de advertencia. El aviso que nos muestra contiene un enlace en azul: **Promover este servidor a controlador de dominio**. Hacemos clic ah칤.

![Captura apartado 2](pr0501_Capturas/pr0501_2.png)

Se nos abrir치 una ventana para configurar el servicio de domino de Active Directory.
En el primer apartado indicaremos que queremos crear un nueov 치rbol seleccionando el 칰ltimo bot칩n de radio e indicaremos el dominio ra칤z escribiendolo en el cuadro de texo, en este caso: "iessanadres.local".

![Captura apartado 3](pr0501_Capturas/pr0501_3.png)

En el siguiente apartado dejaremos los deplegables referentes a Nivel funcional con su valor por defecto y tampoco modificaremos las casillas de debajo. Deveremos abajo indicar una contrase침a para el modo restauraci칩n.

>游눠 Al tener la directiva de complejidad de contrase침a activada por defecto, hay que tener en cuenta que la contrase침a debe tener 8 car치cteres como m칤nimo y debe tener n칰meros y letras.

![Captura apartado 4](pr0501_Capturas/pr0501_4.png)

En el siguiente apartado lo dejamos tal cual est치 y le damos a Siguiente.

En la siguiente parte de la configuraci칩n debermos asignarle un nombre de dominio NetBIOS. Por defecto nos pondr치 uno en base al nombre de dominio que pusimos nosotros pero quitanod la extensi칩n ".local" y en may칰sculas.

![Captura apartado 5](pr0501_Capturas/pr0501_5.png)

La siguiente parte aparecen las rutas, que las dejaremos por defecto y le daremos a Siguiente.

Ahora aparecer치 un resumen de las opciones que hemos seleccionado, las revisamos por si acaso y continuamos.

Ahora har치 una comprobaci칩n de requisitos previos donde nos aparecer치n algunos avisos. Al no ser demasiado relevantes, podemos darle a Instalar.

![Captura apartado 6](pr0501_Capturas/pr0501_6.png)

Al instalarse, pedir치 que reiniciemos el sistema,esto suele tomarse su tiempo as칤 que tendremos paciencia.

![Captura apartado 7](pr0501_Capturas/pr0501_7.png)

Cuando se reinicie la m치quina ya al iniciar sesi칩n veremos que nos indica el dominio en que se encuentra el usuario antes de su nombre

![Captura apartado 8](pr0501_Capturas/pr0501_8.png)

Cuando inicie el Administrador del servidor veremos que ha instalado el servidor AD DS Y el servidor DNS.

![Captura apartado 9](pr0501_Capturas/pr0501_9.png)

## Ejercicio 2 - Dise침o de la Estructura de Unidades Organizativas (UO).

Para empezar a estructurar la jerarqu칤a iremos desde el Adminsitrador del Servidor a Herramientas en el men칰 superior a la derecha. Haremos clic en **Centro de administraci칩n de Active Directory**. Esto nos abrir치 una ventana nueva donde podremos configurar diferentes aspectos de Active Directory.

En el men칰 de la izquierda haremos clic en "iessanandres(local)", esto nos abrir치 una estructura de carpetas en el panel central, siendo una de ellas l침a carpeta Users. Si hacemos clic en esa carpeta nos aparecer치 un puque침o men칰 a la derecha donde est치 la opci칩n de **Nuevo**, si ponemos el rat칩n ah칤 veremos que podemos crear IbetOrgPerson, Grupos, Usuarios, Equipos y Unidades Organizativas, tal y como necesitamos.

![Captura apartado 10](pr0501_Capturas/pr0501_10.png)

- IES San Andres (UO Ra칤z para la gesti칩n del centro)
    - Alumnado
        - Informatica
            - DAM
            - DAW
            - ASIR
            - SMR
            - IAyBD
        - Administracion
            - AFI
            - GAD
            - SCO 
    - Profesorado
        - InformaticaProf
        - AdministracionProf
    - Personal_PAS (Personal de Administraci칩n y Servicios)
    - _Grupos (UO para almacenar todos los grupos de seguridad)
    - _Equipos (UO para los equipos del dominio)
        - Aulas_Informatica
        - Aulas_Administracion
        - Despachos

> **Justificaci칩n del cambio de la estructura:** Seg칰n como estaba planteada la estructura, los profesores se encontraban dentro del apartado de alumnos (que igual es una errata), cosa que no ten칤a mucho sentido.

Para realizar este ejercicio desde el Administrador del servidor de Windows Server vamos a Herramientas > Usuarios y **Equipos de Active Directory**.

![Captura apartado 11](pr0501_Capturas/pr0501_11.png)

Dede esta ventana iremos creando la estructura creando equipos correspondientes a cada escal칩n en la estructura. Haremos todo como Unidades Organizativas.

La estructura deber치 quedar as칤:

![Captura apartado 12](pr0501_Capturas/pr0501_12.png)

## Ejercicio 3 - Creaci칩n de Usuarios y Grupos.

Probaremos la estructura de la siguiente manera:

### 1. Crear Usuarios

Para crear los usuarios dentro de la Unidad organizativa haremos clic derecho y le daremos a **Nuevo > Usuario**.

Nos pedir치 en primera instancia indicar el nombre del usuario as칤 como el nombre con el que se le va a referenciar y en segundo lugar nos aparecer치 una ventana para indicar su contrase침a

![Captura apartado 13](pr0501_Capturas/pr0501_13.png)

![Captura apartado 14](pr0501_Capturas/pr0501_14.png)

> A la hora de asignar la contrase침a hay que tener cuidado con la directiva de contrase침as, la complejidad de contrase침as est치 activada por lo que hay que poner una contrase침a de m치s de 8 car치cteres con may칰sculas, min칰sculas y alg칰n car치cter num칠rico.

Haremos este proceso para crear los siguientes usuarios:

- 2 usuarios en la UO ASIR

El nombre de estos usuarios ser치 **alu_asir_1**, y **alu_asir_2**

![Captura apartado 15](pr0501_Capturas/pr0501_15.png)

- 2 usuarios en la UO AFI

El nombre de estos usuarios ser치 **alu_afi_1**, y **alu_afi_2**

![Captura apartado 16](pr0501_Capturas/pr0501_16.png)

- 1 usuario en la UO Profesorado > Inform치tica

El nombre de estos usuarios ser치 **prof_info_1**

![Captura apartado 17](pr0501_Capturas/pr0501_17.png)

- 1 usuario para la UO Personal_PAS

El nombre de estos usuarios ser치 **pas_1**

![Captura apartado 18](pr0501_Capturas/pr0501_18.png)

El resultado de la estructua con todos los usuarios es la siguiente:

![Captura apartado 19](pr0501_Capturas/pr0501_19.png)

### 2. Crear Grupos de Seguridad

Para este ejercicio crearemos Grupos dentro de la UO de _Grupos, para ello haciendo clic derecho sobre **_Grupos** escogeremos **Nuevo > Grupo**.

Nos aparecer치 una ventana para rellenar los datos del grupo:

![Captura apartado 20](pr0501_Capturas/pr0501_20.png)

A침adiremos los siguientes grupos:

- GRP_Alumnos_DAM
- GRP_Alumnos_AFI
- GRP_Profesores_Informatica
- GRP_Personal_PAS
- GRP_Alumnos_General (Un grupo que contendr치 a todos los alumnos)
- GRP_Profesores_General (Un grupo que contendr치 a todos los profesores)

La estructura final es la siguiente:

![Captura apartado 21](pr0501_Capturas/pr0501_21.png)

### 3. Asignar Miembros

Para asignar miembros hay 2 m칠todos:

- Asignarlo desde el usuario yendo a propiedades del usuario > Miembro de y Agregar al grupo al que pertenece

- Desde el grupo, accedemos a propiedades del grupo > Miembros y a침adimos los miembros a mano.

Las dos opciones son v치lidas, en este caso hice la primera opci칩n.

Accedemos a las propiedades de los usuarios (Clic derecho > Propiedades) Y vamos a la pesta침a Miembro de:

![Captura apartado 22](pr0501_Capturas/pr0501_22.png)

le daremos a Agregar y en el cuadro de texto escribiremos el nombre del grupo.

![Captura apartado 23](pr0501_Capturas/pr0501_23.png)

Despu칠s de esto le damos a confirmar.

> Para a침adir grupos dentro de grupos se puede hacer tambi칠n desde Propiedades del Grupo.

El resultado de las asignaciones es el siguiente viendolo desde los grupos viendo qui칠nes son los miembros.

- GRP_Profesores_General:

![Captura apartado 24](pr0501_Capturas/pr0501_24.png)

- GRP_Alumnos_General:

![Captura apartado 25](pr0501_Capturas/pr0501_25.png)

- GRP_Personal_PAS:

![Captura apartado 26](pr0501_Capturas/pr0501_26.png)

- GRP_Profesores_Informatica:

![Captura apartado 27](pr0501_Capturas/pr0501_27.png)

- GRP_Alumnos_AFI

![Captura apartado 28](pr0501_Capturas/pr0501_28.png)

> Como el la creaci칩n de usuarios la hicimos de alumnos de asir pero los grupos pide expresamente el grupo de alumnos de DAM, he dejado el grupo de alumnos de DAM vac칤o y los alumnos de ASIR sin asignar, ya que no tiene sentido que pertenezcan a un grupo que no es el suyo.

## Ejercicio 4 - Restricci칩n de Horas de Inicio de Sesi칩n.

Para asignar un Horario a un usuario se hace desde las propiedades del Usuario en la pesta침a Cuenta.

En este caso como nos piden varios usuarios podemos seleccionar varios usuarios a la vez, de la misma manera haremos clic derecho e iremos al apartado Propiedades y a la pesta침a Cuenta.

Activaremos el *checkbox* de Horario de sesi칩n y le daremos al bot칩n de la derecha para configurarlo

![Captura apartado 29](pr0501_Capturas/pr0501_29.png)

La forma de configurarlo es marcar con cuadraditos azules las horas activas correspondientes a cada d칤a de la semana. Para que nos quede claro que hemos seleccionado podemos leer la parte de abajo de la izquierda que aparece escrito.

![Captura apartado 30](pr0501_Capturas/pr0501_30.png)

Para ahora comprobar a al usuario del profesor y el personal pas lo haremos de forma individual. Se hace de la misma manera, accedemos a las propiedades del usuario y vamos a la pesta침a de Cuenta, ah칤 buscaremos un bot칩n que indique **Horas de inicio de sesi칩n**

![Captura apartado 31](pr0501_Capturas/pr0501_31.png)

Una vez le hemos dado comprobarmos los cuadraditos azules que deben estar marcados todos, de esta forma:

![Captura apartado 32](pr0501_Capturas/pr0501_32.png)

Lo comprobamos tambi칠n en el usuario del profesor:

![Captura apartado 33](pr0501_Capturas/pr0501_33.png)


------------

#### [Volver a Unidad 5](../index.md)