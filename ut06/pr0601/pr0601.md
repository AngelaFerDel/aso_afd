#### [Volver a Unidad 6](../index.md)

------------

# Unidad 6 - Práctica 1: Introducción a Powershell.

## Bloque 1: Descubrimiento y ayuda.

1. Búsqueda por nombre (Sustantivo):

- Lista todos los comandos disponibles en el sistema que tengan la palabra Service en su nombre (noun) para identificar qué herramientas tienes para gestionar servicios.

`Get-Command -Noun Service`

2. Búsqueda por acción (Verbo): 

- Lista todos los comandos disponibles cuya acción sea Stop (detener), independientemente de lo que detengan.

`Get-Command -Verb Stop`

3. Uso de la ayuda:

- Muestra por pantalla la ayuda detallada del comando Get-Process, pero asegúrate de que se muestren específicamente los ejemplos de uso.

`Get-Help -Name Get-Process -Full`

## Bloque 2: Exploración de objetos

1. Introspección de tipos:

- Ejecuta el comando para obtener la fecha actual (Get-Date) pero canaliza su salida para ver la lista de sus Miembros (Members).

Comando para ver la fecha:

`Get-Date`

Comando para ver su lista de Miembros:

`Get-Date | Get-Member`

- ¿Cuál es el TypeName del objeto devuelto?.

Una vez ejecutas el comando `Get-Date | Get-Member` en la primera línea especifica su TypeName. En este caso: `System.DateTime`

2. Identificación de Propiedades vs Métodos: 

- Usando el comando Get-Member sobre un proceso cualquiera (ej: Get-Process), identifica el nombre de un Método que permita finalizar (matar) el proceso.

Se puede buscar a mano a simple vista cuando ejecutamos el comando

`Get-Process | Get-Member`

Veremos que en la columna MemberType existen diferentes tipos entre ellos Method. Uno de ellos se llama Kill y su descripción es `void kill()`

También es posible filtrar el resultado para que solo nos aparezcan métodos o que en su nombre lleve la palabra Kill.

`Get-Process | Get-Member | Where-Object Name -eq "kill"`

`Get-Process | Get-Member | Where-Object MemberType -eq "Method"`

## Bloque 3: El Pipeline (selección y ordenación)

1. Selección de columnas:

- Obtén la lista de todos los procesos, pero muestra por pantalla únicamente las propiedades Id y ProcessName. El resto de información debe ser descartada.

`Get-Process | Select-Object Id, ProcessName`

2. Ordenación básica:

- Lista todos los procesos del sistema, ordenados por su consumo de CPU de forma descendente (el que más consume primero).

`Get-Process | Sort-Object cpu -descending`

3. Formato de tabla:

- Obtén los servicios del sistema y fuerza la salida para que se muestre como una tabla (Format-Table) que se auto-ajuste (-AutoSize) al ancho de la ventana.

Podemos hacerlo empleando el nombre completo del comando para dar el formato de tabla:

`Get-Process | Format-Table -AutoSize`

O podemos emplear el aslias, que lo hac eun poco más corto:

`Get-Process | ft -AutoSize`

## Bloque 4: Filtrado y lógica (Where-Object)

1. Filtrado exacto: 

- Muestra una lista de los servicios cuyo estado (Status) sea exactamente igual (-eq) a “Running”.

`Get-Service | Where-Object Status -eq "Running"`

2. Filtrado numérico:

- Lista los procesos cuyo identificador (Id) sea mayor que (-gt) 2000.

`Get-Process | Where-Object Id -gt 2000`

3. Filtrado con comodines: 

- Busca y muestra todos los procesos cuyo nombre (Name) comience por la letra “s” utilizando el operador -like y el comodín adecuado.

`Get-Process | Where-Object Name -like s*`

`Get-Process | Where-Object ProcessName -like s*`

## Bloque 5: Agrupación y estadísticas

1. Agrupación de datos: 

- Agrupa todos los servicios del sistema en función de su Status. El comando debe devolverte cuántos hay en cada grupo.

`Get-Service | Group-Object -Property Status`

2. Cálculo estadístico: 

- Obtén el listado de archivos del directorio actual (Get-ChildItem). Usando una tubería, calcula el promedio (Average) de la propiedad Length (tamaño) de todos los archivos.

`Get-ChildItem | Measure-Object -Property Length -Average`

## Bloque 6: Gestión del Historial

1. Consulta de actividad: 

- Muestra por pantalla la lista de los últimos comandos que has ejecutado en la sesión actual.

`Get-History`

> Foto del resultado de los comandos donde se ve que he ido realizando la práctica y ejecutando los diversos comandos.

![Captura](pr0601_Capturas/pr0601_1.png)

2. Exportación de datos:

- Exporta todo tu historial de comandos actual a un archivo en formato CSV llamado historial_lab.csv.

En este caso voy a hacer el archivo CSV en mi carpeta documenos de mi usuario:

`Get-History | Export-Csv -Path 'C:\Users\angela.ferdel.1\Documents\history.csv'`

![Captura](pr0601_Capturas/pr0601_2.png)

Si lo abrimos por ejemplo desde el Visual Studio Code podemos ver su contenido y ver que realmente es el historial de ocmando que hemos empleado.

![Captura](pr0601_Capturas/pr0601_3.png)

------------

#### [Volver a Unidad 6](../index.md)